@model BookingTicket.ViewModels.HallViewListingModel

@{
    ViewBag.Title = "Index";
}

<div class="container" style="margin-top: 56px;">
    <a id="addNewHallBtn" class="btn btn--shine" style="float: right;">Dodaj salu</a>
    <table class="table table-hover text-center">
        <thead>
            <tr>
                <th>Name</th>
                <th>Number Of Seats</th>
                <th>Type</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
           @foreach(var hall in Model.Halls)
           {
               <tr>
                   <td>@hall.Name</td>
                   <td>@hall.NumberOfSeats</td>
                   <td>@hall.Type</td>
                   <td>
                       <a data-id="@hall.HallId" class="btn btn--default hallBtnEdit">Edit</a>
                       <a data-id="@hall.HallId" class="btn btn--danger hallBtnDelete">X</a>
                   </td>
               </tr>
           }
        </tbody>
    </table>
</div>
<div id="hallActionContainer" class="container">

</div>

<script>
    function focusAction(controlToFocus) {
        $("html, body").animate({
            scrollTop: $("#" + controlToFocus).offset().top - 100
        }, 1000);
    }

    $("#addNewHallBtn").click(function () {
       $.ajax({
                url: '@Url.Action("AddHall", "Hall")',
            })
                .done(function (response) {
                    $("#hallActionContainer").html(response);
                    focusAction("hallActionContainer");
                })
                .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Fail")
                });
    });

    $(".hallBtnEdit").click(function () {
       $.ajax({
           url: '@Url.Action("EditHall", "Hall")',
           data: {
               Id: $(this).attr("data-id")
           }
            })
                .done(function (response) {
                    $("#hallActionContainer").html(response);
                    focusAction("hallActionContainer");
                })
                .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Fail")
                });
    });

    $(".hallBtnDelete").click(function () {
    swal({
        text: "Da li ste sigurni da želite da izbrišete ovu salu?",
        icon: "warning",
        buttons: true,
        dangerMode: true,
    })
        .then((willDelete) => {
            if (willDelete) {
                $.ajax({
                    type: 'POST',
                    url:'@Url.Action("DeleteHall","Hall")',
                    data: {
                        Id: $(this).attr('data-id'),
                    }
                })
                    .done(function (response) {
                        swal("Sala je uspešno izbrisana!", {
                            icon: "success",
                        }).then((value) => {
                          window.location = '@Url.Action("Index","Hall")';
                      });
                    })
                    .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                        alert("Fail")
                    });
            }
        });
});
</script>

